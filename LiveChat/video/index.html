<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>LiveChat Video - Zefren</title>
	<link rel="stylesheet" href="style.css">
</head>

<body onload="ChangeVideo()">
	<h1 id="texteAvatar" class="avatarTexte"></h1>
	<img id="avatar" class="avatarImg" width="150" height="150" src="https://cdn.discordapp.com/attachments/1076908168132694048/1077592007175831562/vide.png">
	<h1 id="texteVid" class="contentTexte">SALUT A TOUS</h1>
	<video muted id="video" src="https://cdn.discordapp.com/attachments/1076908168132694048/1077597865058242600/srdfgsdehuderhj.mp4">
	</video>
	<input id="btnMute" type="button" value="Unmute">
	<script>
		const video = document.getElementById("video");
		let btn = document.querySelector('input');
		let texteVideo = "";
		let time = 20000;
		let height = 1080;
		let width = 1920;
		let avatar = "https://cdn.discordapp.com/attachments/1076908168132694048/1077592007175831562/vide.png";
		let username = "";
		const imgAvatar = document.getElementById("avatar");
		let urlRecu = "https://cdn.discordapp.com/attachments/1076908168132694048/1077597865058242600/srdfgsdehuderhj.mp4";
		
		function Database() {
			let ajax = new XMLHttpRequest();
			let method = "GET";
			let url = "../getValue.php";
			let asynchronous = true;

			ajax.open(method, url, asynchronous);
			ajax.send();
			ajax.onload = function() {
				let messageRecu = this.responseText.split("$");
				if (messageRecu[3] != urlRecu) {
					time = messageRecu[0];
					setTimeout(
						function() {
							Clear();
						}, time);
				width = messageRecu[1];
				video.width = width;
				height = messageRecu[2];
				video.height = height;
				urlRecu = messageRecu[3];
				avatar = messageRecu[6];
				imgAvatar.src = "" + avatar;
				username = messageRecu[7];
				document.getElementById("texteAvatar").textContent = username;
				video.src = "" + urlRecu;
				video.load();
				video.play();

				setTimeout(
					function() {
						document.getElementById("btnMute").style.display = "block";
						clickButton();
					}, 1000);
					texteVideo = messageRecu[4];
					document.getElementById("texteVid").textContent = texteVideo;
				}
			}
		}

		function Clear() {
			video.src = "";
			document.getElementById("texteVid").textContent = "";
			document.getElementById("btnMute").style.display = "none";
			document.getElementById("texteAvatar").textContent = "";
			imgAvatar.src = "https://cdn.discordapp.com/attachments/1076908168132694048/1077592007175831562/vide.png";
		}

		btn.addEventListener("click", function() {
			document.getElementById("btnMute").style.display = "none";
			video.muted = !video.muted;
			video.volume = 0.1;
			video.play();
		});

		// Simulate click function
		function clickButton() {
			btn.click();
		}


		function ChangeVideo() {

			const interval = setInterval(function() {
				Database();
			}, 7000); //DÃ©lai de scrutation pour chaque video
		}
	</script>
</body>

</html>
